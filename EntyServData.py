# -*- coding: utf-8 -*-
"""
Created on Wed Mar 10 16:09:38 2021

Run Data Query via Entity Service REST API

@author: TQiu
"""

import pandas as pd
import datetime


def isValidESSecurityFields(cols):
    """
    Inputs>>
    cols: comma delimitted list of valid fields (as per API documentation)
    Outputs>>
    boolean: indicator if fields are all valid
    """
    valid_cols = 'date, securityId, LSpropCollateralNetCoupon, LSpropCurrentCouponSpreadSensitivity, LSpropDiscountMargin, LSpropDuration, LSpropEffectiveConvexity, LSpropEffectiveDuration, LSpropEffectiveYield, LSpropLiborOptionAdjustedSpread, LSpropOptionAdjustedSpread, LSpropOriginationYear, LSpropPartialDuration02Year, LSpropPartialDuration05Year, LSpropPartialDuration07Year, LSpropPartialDuration10Year, LSpropPartialDuration20Year, LSpropPartialDuration30Year, LSpropPartialDurationCustom, LSpropPrepayDuration, LSpropPrice, LSpropSpreadConvexity, LSpropSpreadDelta7Day, LSpropSpreadDeltaMtd, LSpropSpreadDeltaNinetyDay, LSpropSpreadDeltaOneDay, LSpropSpreadDeltaQtd, LSpropSpreadDeltaThirtyDay, LSpropSpreadDeltaYtd, LSpropSpreadDuration, LSpropSpreadDurationPlusCouponSensitivity, LSpropSpreadPercentChange7Day, LSpropSpreadTimesSpreadDuration, LSpropVolatilityDuration, LSpropWeightedAverageLife, LSpropYieldToMaturity, LSpropYieldToWorst, LSpropZeroVolatilitySpread, adjustedKeyRateDurationBeta100DayTotal, adjustedKeyRateDurationBetaTotal, bankLoanRating, base12MonthExcessReturn, base12MonthReturn, braeburnPrice, compModifiedDurationToWorst, compSpreadPercentChangeMtd, compSpreadPercentChangeNinetyDay, compSpreadPercentChangeOneDay, compSpreadPercentChangeQtd, compSpreadPercentChangeThirtyDay, compSpreadPercentChangeYtd, convexity, coupon, cs01, currentCouponSpreadSensitivity, currentDividendYield, currentYield, customSecuritizedDuration, cv01, dirtyPrice, divYld12Months, dividendPaid, downside12MonthExcessReturn, downside12MonthReturn, duration, dv01, effectiveDuration, empiricalDuration, empiricalDurationRSquared, empiricalKeyRateDurationFiveYear, empiricalKeyRateDurationOffset, empiricalKeyRateDurationSixMonth, empiricalKeyRateDurationTenYear, empiricalKeyRateDurationThirtyYear, empiricalKeyRateDurationTwentyYear, empiricalKeyRateDurationTwoYear, faceValueFactor, feEst3to5YrEpsMeanLtGrowth, feForwardPe, feTrailingPe, ffAssetsAnnual, ffCapexPctSalesAnnual, ffCashFromOperationsAnnual, ffCashQtrly, ffDebtAnnual, ffDebtQtrly, ffDebtToCapital, ffDebtToCapitalDs, ffDivYldLastDivTimes4PlusSpec, ffDividendPayoutRatioAnnual, ffDividendsPerShareAnnual, ffEbitMarginAnnual, ffEbitdaMarginAnnual, ffEnterpriseValueQtrly, ffEpsAnnual, ffEpsLtm, ffEquityAnnual, ffFcfPerShareAnnual, ffFcfYieldDs, ffFreeCashFlowAnnual, ffFreeCashFlowPerShareLtm, ffGrossProfitMarginAnnual, ffLtDebtToCapitalAnnual, ffMarketCapAnnual, ffMarketCapDaily, ffMarketCapMillionsQtrly, ffNetIncomeAnnual, ffPToEDaily, ffPToEQtrly, ffPriceToBookDaily, ffPriceToBookDs, ffPriceToBookValueQtrly, ffPriceToCashFlow, ffPriceToCashFlowAnnual, ffPriceToCashFlowQtrly, ffPriceToCashflowDs, ffPriceToSales, ffPriceToSalesAnnual, ffPriceToSalesQtrly, ffReturnOnAssetsAnnual, ffRoeAnnual, ffRoeDs, ffSalesGrowthAnnual, ffSharesQtrly, ffSplitAdjPriceDaily, ffTaxRateAnnual, ffTotalDebtToEquity, ffTotalDebtToEquityAnnual, ffTotalDebtToEquityQtrly, ffTotlDivAnnual, fvSpread, hedgeCostAdjustedYieldAud1m, hedgeCostAdjustedYieldAud3m, hedgeCostAdjustedYieldCad1m, hedgeCostAdjustedYieldCad3m, hedgeCostAdjustedYieldEur1m, hedgeCostAdjustedYieldEur3m, hedgeCostAdjustedYieldGbp1m, hedgeCostAdjustedYieldGbp3m, hedgeCostAdjustedYieldJpy1m, hedgeCostAdjustedYieldJpy3m, hedgeCostAdjustedYieldNok1m, hedgeCostAdjustedYieldNok3m, hedgeCostAdjustedYieldNzd1m, hedgeCostAdjustedYieldNzd3m, hedgeCostAdjustedYieldSgd1m, hedgeCostAdjustedYieldSgd3m, hedgeCostAdjustedYieldUsd1m, hedgeCostAdjustedYieldUsd3m, impliedMbsCouponSwapConvexity, impliedMbsCouponSwapDuration, invertedFaceValueFactor, keyRateDurationBeta100DayFiveYear, keyRateDurationBeta100DayOneYear, keyRateDurationBeta100DaySevenYear, keyRateDurationBeta100DaySixMonths, keyRateDurationBeta100DayTenYear, keyRateDurationBeta100DayThirtyYear, keyRateDurationBeta100DayThreeYear, keyRateDurationBeta100DayTwentyYear, keyRateDurationBeta100DayTwoYear, keyRateDurationBetaFiveYear, keyRateDurationBetaOneYear, keyRateDurationBetaSevenYear, keyRateDurationBetaSixMonths, keyRateDurationBetaTenYear, keyRateDurationBetaThirtyYear, keyRateDurationBetaThreeYear, keyRateDurationBetaTwentyYear, keyRateDurationBetaTwoYear, keyRateDurationFiveYear, keyRateDurationOneYear, keyRateDurationSevenYear, keyRateDurationSixMonths, keyRateDurationTenYear, keyRateDurationThirtyYear, keyRateDurationThreeYear, keyRateDurationTwentyYear, keyRateDurationTwoYear, liborConvexity, liborDuration, liborSpread, liborSpreadDuration, liborZeroVolatilitySpread, liquidityCostScore, macaulayDurationToWorst, modifiedDurationToWorst, msciEsgCorpBusinessEthicsThemeScore, msciEsgCorpBusinessEthicsThemeWeight, msciEsgCorpCarbonEmissionsScore, msciEsgCorpCarbonEmissionsWeight, msciEsgCorpClimateChangeThemeScore, msciEsgCorpClimateChangeThemeWeight, msciEsgCorpCorporateGovThemeScore, msciEsgCorpCorporateGovThemeWeight, msciEsgCorpEnvironOppsThemeScore, msciEsgCorpEnvironOppsThemeWeight, msciEsgCorpEnvironmentalPillarScore, msciEsgCorpEnvironmentalPillarWeight, msciEsgCorpGovernancePillarScore, msciEsgCorpGovernancePillarWeight, msciEsgCorpGovtPubPolThemeScore, msciEsgCorpGovtPubPolThemeWeight, msciEsgCorpHumanCapitalThemeScore, msciEsgCorpHumanCapitalThemeWeight, msciEsgCorpIndustryAdjustedScore, msciEsgCorpNaturalResUseThemeScore, msciEsgCorpNaturalResUseThemeWeight, msciEsgCorpProdCarbFtprntExpScore, msciEsgCorpProdCarbFtprntMgmtScore, msciEsgCorpProdCarbFtprntScore, msciEsgCorpProdCarbFtprntWeight, msciEsgCorpProductSafetyThemeScore, msciEsgCorpProductSafetyThemeWeight, msciEsgCorpSocialOppsThemeScore, msciEsgCorpSocialOppsThemeWeight, msciEsgCorpSocialPillarScore, msciEsgCorpSocialPillarWeight, msciEsgCorpWasteMgmtThemeScore, msciEsgCorpWasteMgmtThemeWeight, mtgGenericCprOneMonth, mtgGenericCprSixMonth, mtgGenericCprThreeMonth, mtgPoolCprOneMonth, mtgPoolCprSixMonth, mtgPoolCprThreeMonth, optionAdjustedConvexity, optionAdjustedDuration, price, priceDelta180Day, priceDelta1Day, priceDelta30Day, priceDelta60Day, priceDelta7Day, priceDelta90Day, priceDeltaMTD, priceDeltaQTD, priceDeltaYTD, satAveragePrice, satDistressedLiquidity, satZvSpread, sfDuration, sfKeyRateDurationFiveYear, sfKeyRateDurationSevenYear, sfKeyRateDurationSixMonths, sfKeyRateDurationTenYear, sfKeyRateDurationThirtyYear, sfKeyRateDurationTwentyYear, sfKeyRateDurationTwoYear, sfOptionAdjustedConvexity, sfOptionAdjustedSpread, sfOptionAdjustedSpreadDuration, sfPrice, sfRiskModelTwoBeta, sfVolatilityDuration, spread, spreadConvexity, spreadDelta180Day, spreadDelta1Day, spreadDelta30Day, spreadDelta7Day, spreadDelta90Day, spreadDeltaMTD, spreadDeltaQTD, spreadDeltaYTD, spreadDuration, spreadDurationDeltaDays001, spreadDurationDeltaDays007, spreadDurationDeltaDays030, spreadDurationDeltaDays090, spreadDurationDeltaDays180, spreadDurationDeltaPeriodMTD, spreadDurationDeltaPeriodQTD, spreadDurationDeltaPeriodYTD, spreadDurationPlusCouponSensitivity, spreadSCR, spreadTimesSpreadDuration, spreadToBenchmark, upside12MonthExcessReturn, upside12MonthReturn, volatilityDuration, wac, yasIspreadToGovt, yearsToAverageLife, yearsToEffectiveMaturity, yearsToMaturity, yearsToWorst, yield, yieldToMaturity, yieldToWorst, zeroVolatilitySpread, FD_AdjustedTicker, FD_BestIdea_1, FD_CPFD_BI_Target, FD_CountryOfRisk_1, FD_CountryOfRisk_2, FD_Country_1, FD_Country_2, FD_Currency_1, FD_Custom_1, FD_Custom_2, FD_Custom_3, FD_Custom_4, FD_Custom_Theme_1, FD_Custom_Theme_2, FD_Custom_Theme_3, FD_Custom_Theme_4, FD_ES_B, FD_HYCV_BI_Target, FD_HYFD_BI_Target, FD_MSFDA_BI_Target, FD_MSFD_BI_Target, FD_Marketing_1, FD_Marketing_2, FD_SecuritizedTheme, FD_ThemeType, LSpropCollateral, LSpropTicker, abstratDerivative, abstratEmerging, abstratIndustry, abstratRating, abstratRegionOfRisk, abstratWCAF, accruedInterest, adrShPerAdr, agencyGroup, aifmFlag, amountOutstanding, analyst, analystFirstName, analystGroupDesc, analystGroupId, analystInitials, analystLastName, analyticExceptionFlag, appraisalTypeName, askPrice, assetClass, austrailianSanctionStatus, avgVolume30Day, bankLoanLiborFloor, bankLoanReissueFlag, bankLoanSpread, bankloanStdLoanDesc, bankloanStdLoanDescCode, bartClusterIndustryDts10_20Factor, bartClusterIndustryDts10_20Name, bartClusterIndustryRatingFactor, bartClusterIndustryRatingName, bbBlId, bbCompCd, bbCrpEqTk, bbGlCd, bbShortName, bbUniqCd, bidPrice, bloombergIndustrySubgroupCode, bloombergIndustrySubgroupName, bric, brics, bvalPrice, calculatedGSpread, calculatedGSpreadLatest, calculatedRollSpreadNetResidualSpread, calculatedRollSpreadNetResidualSpreadDelta30Day, calculationUnit, callAnnouncementDate, callType, callable, canadianSanctionStatus, capStructureType, carbonEmissIntensityYear, carbonEmissScope1, carbonEmissScope12, carbonEmissScope12Inten, carbonEmissScope12Key, carbonEmissScope1Key, carbonEmissScope2, carbonEmissScope2Key, carbonEmissScope3, carbonEmissScp12IndInten, carbonEmissScp12Inten3yav, carbonEmissYear, carbonSalesIntensityRecent, cdxType, citiLevelFourCode, citiLevelFourName, citiLevelOneCode, citiLevelOneName, citiLevelThreeCode, citiLevelThreeName, citiLevelTwoCode, citiLevelTwoName, coalPotentialEmissions, collateral, collateralNetCoupon, compYieldSourceName, companyCorporateTicker, companyName, convOilAnalystComments, conversionPercentPremium, convertGamma, convertGammaPerShare, convertSensitivityType, convertiblePreferredScheme, countryCode, countryDescription, countryOfDomicile, countryOfDomicileName, countryOfRisk, countryOfRiskName, couponBand, couponFrequency, couponType, crAnalystId, crBaseCase, crBestCase, crDownsideCase, crFirstName, crInitials, crLastName, crTargetDate, crWorstCase, creditBucket, creditBucketExNr, creditScopeScore, currencyCode, currencyCodeModifiedForOptions, currencyCountryIssuance, currencyDescription, currencyForward, currencyForwardOffset, currencyNameModifiedForOptions, currencyType, curroptFlag, cusip, cusip9, customBarclaysSecuritizedLevelFour, customBarclaysSecuritizedLevelOne, customBarclaysSecuritizedLevelThree, customBarclaysSecuritizedLevelTwo, customClusterCode, customClusterName, customClusterUltimateParentCompanyName, customMAIF, dateReviewed, datedDate, dayCountMethod, defaultSecurityId, deltaClean, deltaModelS, derivative, derivativeOffset, downgradeRisk, ebitdaOperationsAnnual, ebitdaOperationsAnnualDate, ebitdaOperationsQuarter, ebitdaOperationsQuarterDate, eiopaDownDelta, eiopaUpDelta, emCustomFitchNumericRating, emCustomFitchRating, emCustomIndustryLevelCode, emCustomIndustryLevelName, emCustomMoodyNumericRating, emCustomMoodyRating, emCustomStandardPoorsNumericRating, emCustomStandardPoorsRating, emTeamCountryOfRisk, emTeamCountryOfRiskName, emergingMarketCurrencyRegion, emergingMarketLevelFiveScheme, emergingMarketLevelFourScheme, emergingMarketLevelOneScheme, emergingMarketLevelSevenScheme, emergingMarketLevelSixScheme, emergingMarketLevelThreeScheme, emergingMarketLevelTwoScheme, equityRepSecId, erisaEligible, estimatedPriceEarningOneYear, euroCreditDurationTimesSpread, euroCreditSectorMapping, europeanUnionSanctionStatus, expirationDate, facilityCode, facilityName, fas157PriceRank, fdIrrBucket, fdMarketingTest1, fdMarketingTest2, fdTestLevelFour, fdTestLevelOne, fdTestLevelThree, fdTestLevelTwo, fdsPermId, fedSupport, ffIndustry, ffName, ffTicker, firstCouponDate, fitchOnlySplitRating, fitchOnlySplitRatingBandName, fitchOnlySplitRatingMapped, fitchOutlook, fitchRating, fitchUnderlyingRating, fitchWatch, floatingCouponType, fullDiscretionFourTheme, fullDiscretionOneTheme, fullDiscretionThreeTheme, fullDiscretionTwoTheme, fullInventoryMarketValue, fullInventoryQuantity, fullInventoryWeight, fvOasTermMatched, fvOasTermMatchedLgd60, fxRate, geiRegionDesc, geoAnalystId, geoBaseCase, geoBestCase, geoDownsideCase, geoFirstName, geoInitials, geoLastName, geoTargetDate, geoWorstCase, gic, gicsLevelFourCode, gicsLevelFourName, gicsLevelOneCode, gicsLevelOneName, gicsLevelThreeCode, gicsLevelThreeName, gicsLevelTwoCode, gicsLevelTwoName, gicsMapped, globalBarclaysLevelFour, globalBarclaysLevelOne, globalBarclaysLevelThree, globalBarclaysLevelTwo, globalCorpOffshoreProxyCurrency, globalCreditOffshoreProxyCurrency, globalCurrencyCode, globalFactorAttributionScheme, globalGrowthCountryOfRisk, globalGrowthCountryOfRiskName, globalGrowthRegionOfRisk, globalLevelOneScheme, globalLevelThreeScheme, globalLevelTwoScheme, globalObligorCompanyBbId, globalOpportunisticOffshoreProxyCurrency, globalRegionOfRisk, globalTeamCurrencyAllocation, gpsId, grantorTrustFlag, greenBondLoanInd, herMagestysTreasurySanctionStatus, highVolFlag, hongKongSanctionStatus, iboxxLevelFourName, iboxxLevelOneName, iboxxLevelThreeName, iboxxLevelTwoName, iboxxLiborZvSpread, iboxxOaSpreadDur, iboxxZvSpread, iboxxZvSpreadDelta180day, iboxxZvSpreadDelta1day, iboxxZvSpreadDelta30day, iboxxZvSpreadDelta60day, iboxxZvSpreadDelta7day, iboxxZvSpreadDelta90day, iboxxZvSpreadDeltaMtd, iboxxZvSpreadDeltaQtd, iboxxZvSpreadDeltaYtd, iboxxZvSpreadPercentChange180day, iboxxZvSpreadPercentChange1day, iboxxZvSpreadPercentChange30day, iboxxZvSpreadPercentChange60day, iboxxZvSpreadPercentChange7day, iboxxZvSpreadPercentChange90day, iboxxZvSpreadPercentChangeMtd, iboxxZvSpreadPercentChangeQtd, iboxxZvSpreadPercentChangeYtd, iceLiqScrVAllBnds, iceLiqScrVSameAssetClass, iceLiqScrVSameIss, iceLiqScrVSameSector, iceLqScrVSimAmtOutBndACls, iceLqScrVSimDurBndACls, iceLqScrVSimYldMatBndACls, idBbCompany, idBbGlobalCompany, idBbGlobalCompanyName, idBbGlobalObligorCompanyName, idBbParentCo, idBbUltimateParentCo, igHyLehman, illiquid, impairmentRisk, industryGroup, industryLevelFourCode, industryLevelFourName, industryLevelOneCode, industryLevelOneName, industryLevelThreeCode, industryLevelThreeName, industryLevelTwoCode, industryLevelTwoName, industryModelCode, industryOutlook, industrySector, industrySubgroup, inflationLinkedIndicator, instrumentType, instrumentTypeName, internationalSecuritized, inventoryTypeName, isin, issPeqTk, issuance, issueAmount, issueDate, issuePrice, issueType, issueYear, issuerCode, issuerComment, issuerIndustry, issuerName, issuerNameTypes, jpAsiaCreditIndustryLevelCode, jpAsiaCreditIndustryLevelName, jpEmbiIndustryLevelCode, jpEmbiIndustryLevelName, jpIndustryName, lastResearchDate, lccThemeTag, lecSeniority1, lecSeniority2, legalEntityIdentifier, lgAnalystId, lgBaseCase, lgBestCase, lgDownsideCase, lgFirstName, lgInitials, lgLastName, lgTargetDate, lgWorstCase, limitedPartnership, loanPartNote, londonInventory, loomisExpectedRatingChange, loomisFund, loomisGrade, loomisIndustryLevelFourName, loomisQualityOnlySplitRating, loomisQualityOnlySplitRatingBandName, loomisQualityRating, loomisRating, loomisResearchRating, loomisRiskRating, loomisSplitRating, loomisSplitRatingBandName, loomisSplitRatingMapped, ltOutlook, lvAnalystId, lvBaseCase, lvBestCase, lvDownsideCase, lvFirstName, lvInitials, lvLastName, lvTargetDate, lvWorstCase, mandatoryConversionIndicator, marketingMedianSplitRatingBandName, marketingMedianSplitRatingMapped, maturityDate, medianFactorRating, merrillCompositeRating, merrillLevelFourCode, merrillLevelFourName, merrillLevelOneCode, merrillLevelOneName, merrillLevelThreeCode, merrillLevelThreeName, merrillLevelTwoCode, merrillLevelTwoName, metCoalAnalystComments, metCoalReservesVolume, mifidReferenceIndexName, minIncrement, minPiece, mktgIndustryLevelFourName, mktgIndustryLevelOneName, mktgIndustryLevelThreeName, mktgIndustryLevelTwoName, moodyCfrRating, moodyCfrWatch, moodyOnlySplitRating, moodyOnlySplitRatingBandName, moodyOnlySplitRatingMapped, moodyOutlook, moodyRating, moodySpBestLoomisSplitRating, moodySpBestLoomisSplitRatingBandName, moodySpBestLoomisSplitRatingMapped, moodySpBestSplitRating, moodySpBestSplitRatingBandName, moodySpBestSplitRatingMapped, moodySpFitchAverageSplitRating, moodySpFitchAverageSplitRatingBandName, moodySpFitchAverageSplitRatingMapped, moodySpFitchBestLoomisSplitRating, moodySpFitchBestLoomisSplitRatingBandName, moodySpFitchBestLoomisSplitRatingMapped, moodySpFitchBestSplitRating, moodySpFitchBestSplitRatingBand, moodySpFitchBestSplitRatingBandName, moodySpFitchBestSplitRatingMapped, moodySpFitchDuplicateMedianSplitRating, moodySpFitchDuplicateMedianSplitRatingBand, moodySpFitchDuplicateMedianSplitRatingBandName, moodySpFitchDuplicateMedianSplitRatingMapped, moodySpFitchMedianLoomisSplitRating, moodySpFitchMedianLoomisSplitRatingBand, moodySpFitchMedianLoomisSplitRatingBandName, moodySpFitchMedianLoomisSplitRatingMapped, moodySpFitchMedianSplitRating, moodySpFitchMedianSplitRatingBand, moodySpFitchMedianSplitRatingBandRating, moodySpFitchMedianSplitRatingMapped, moodySpFitchWorstLoomisSplitRating, moodySpFitchWorstLoomisSplitRatingBandName, moodySpFitchWorstLoomisSplitRatingMapped, moodySpFitchWorstSplitRating, moodySpFitchWorstSplitRatingBandName, moodySpFitchWorstSplitRatingMapped, moodySpWorstLoomisSplitRating, moodySpWorstLoomisSplitRatingBandName, moodySpWorstLoomisSplitRatingMapped, moodySpWorstSplitRating, moodySpWorstSplitRatingBandName, moodySpWorstSplitRatingMapped, moodySplitRating, moodySplitRatingBandName, moodySplitRatingMapped, moodyUnderlyingRating, moodyWatch, msaaBreakout, msaaBucketCode, msaaBucketDescription, msaaOne, msaaOneCode, msaaSecuritized, msciEsgEPillarScore, msciEsgEPillarWeight, msciEsgGPillarScore, msciEsgGPillarWeight, msciEsgGovnEnvPillarWeight, msciEsgGovnGovPillarWeight, msciEsgGovnSocPillarWeight, msciEsgGovtEnvPillarScore, msciEsgGovtGovPillarScore, msciEsgGovtSocPillarScore, msciEsgSPillarScore, msciEsgSPillarWeight, msciIvaNumericRating, msciIvaRating, msciMktCap, msciesgSinStockAeMaxRevPct, msciesgSinStockAlcMaxRev, msciesgSinStockGamMaxRevPct, msciesgSinStockTobMaxRevPct, msciesgSinStockWeapMaxRevPct, mtgDealName, mtgTrancheTyp, muniIssuerDes2ndLine, muniPrerefundDate, muniPurposeClass, muniPurposeType, muniTaxProv, mvMultiplier, naceSectorCode, name, naturalGasAnalystComments, nextCallDate, nextCallPrice, ngicLevelFourName, obligorBbId, ofacForeignFinancialInstSanctionStatus, ofacFullSancCompany, ofacNonSDNIranSanctionStatus, ofacSectoralSancCo, ofacSectoralSancDirectiveFour, ofacSectoralSancDirectiveOne, ofacSectoralSancDirectiveThree, ofacSectoralSancDirectiveTwo, oilNatGasPotentialEmiss, oilPotentialEmissions, oilSandsAnalystComments, oilSandsPotentialEmissions, omniSectorLevel1, omniSectorLevel2, orderReason, outlook, outstandingFaceValue, parentCompanyName, paymentRank, perpetual, pigs, plsEmpiricalDuration, plsEmpiricalDurationRsquared, plsEmpiricalKrd10Year, plsEmpiricalKrd2Year, plsEmpiricalKrd30Year, plsEmpiricalKrd5Year, plsEmpiricalKrd6Month, prcSrcName, priceBand, pricePercentChange180Day, pricePercentChange1Day, pricePercentChange30Day, pricePercentChange60Day, pricePercentChange7Day, pricePercentChange90Day, pricePercentChangeMtd, pricePercentChangeQtd, pricePercentChangeYtd, privatePlacement, productionYear, ratingBand, ratingBandName, reRemic, regS, regionCode, regionDescription, regionOfRiskCode, regionOfRiskDescription, relativeReturnLevelFourScheme, relativeReturnLevelOneScheme, relativeReturnLevelThreeScheme, relativeReturnLevelTwoScheme, resetIndexName, residualSpread, residualSpreadDelta30Day, residualSpreadLatest, residualSpreadLatestDate, residualSpreadPreviousDay, returnDays001, returnDays007, returnDays030, returnDays090, returnPeriodMTD, returnPeriodQTD, returnPeriodYTD, returnYears01, reviewAnalyst, richCheap10y, richCheap10yLatest, richCheap5y, richCheap5yLatest, richCheapCrossReference, risingStarFallenAngelFlag, riskIndustryLevelFourName, rollSpread, rollSpreadDelta30Day, rollSpreadLatest, rollSpreadLatestDate, rollSpreadPreviousDay, rrClientLevelFiveScheme, rrClientLevelFourScheme, rrClientLevelOneScheme, rrClientLevelSixScheme, rrClientLevelThreeScheme, rrClientLevelTwoScheme, rrYieldToMaturity, rule144a, rule144aStatus, russelLevelFour, russelLevelFourCode, russelLevelOne, russelLevelOneCode, russelLevelThree, russelLevelThreeCode, russelLevelTwo, russelLevelTwoCode, safeIndustry, salesAnnual, salesAnnualDate, salesQuarterly, salesQuarterlyDate, sanfranOnly, sastLiquidity, satBeta, satLiquidity, satVolLevel, sectorCreditOutlookRel, sectorLevel1Name, sectorLevel2Code, sectorLevel2Name, securitized, securitizedCustom1, securitizedGeo, securitizedIsJumbo, securitizedIsPaidOff, securitizedLbRange, securitizedLowLnCnt, securitizedLtvRange, securitizedMaturityBand, securitizedOrigName, securitizedOrigTier, securitizedStrategy, securitizedStrategyAndSubStrategy, securitizedSubStrategy, securitizedTs, securitizedWacRange, securitizedWalBuckets, securitizedWalaRange, securitizedWp, sedol, senior, seniorMostTranche, seniority, shaleGasAnalystComments, shaleOilAnalystComments, shaleOilGasPotentialEmiss, sharesOutstanding, shortName, singaporeanSanctionStatus, sinkType, sinkable, slope10_30, slope2_10, slope2_5, slope5_10, sourceEntity, sourceId, spCcrRating, spCcrWatch, spIndustryLevelFourName, spLongTermForeignCurrencyDebtRating, spLongTermForeignCurrencyIssuerRating, spLongTermLocalCurrencyDebtRating, spLongTermLocalCurrencyIssuerRating, spOnlyRating, spOnlyRatingBandName, spOutlook, spRecoveryRating, spSplitRating, spSplitRatingBandName, spSplitRatingMapped, spUnderlyingRating, spWatch, specPoolType, specificVolatilityDaily, specificVolatilityMonthly, sponsoringEntityGIIN, spreadPercentChange01Day, spreadPercentChange07Day, spreadPercentChange180Day, spreadPercentChange30Day, spreadPercentChange90Day, spreadPercentChangeMtd, spreadPercentChangeQtd, spreadPercentChangeYtd, stOutlook, standardPoorsBandRating, standardPoorsRating, stateOfIncorporation, subordinateType, sustainEsgRiskCategory, sustainEsgRiskPercentileSubindustry, sustainEsgRiskPercentileUniverse, sustainEsgRiskRankSubindustry, sustainEsgRiskRankUniverse, sustainEsgRiskScore, sustainEsgRiskScoreAvgSubindustry, sustainEsgRiskScoreAvgUniverse, sustainEsgRiskScoreDate, sustainOverallBeta, sustainOverallExcessExposureScore, sustainOverallExposureCategory, sustainOverallExposureScore, sustainOverallManageableRiskFactor, sustainOverallManageableRiskScore, sustainOverallManagedRiskScore, sustainOverallManagementCategory, sustainOverallManagementGapScore, sustainOverallManagementScore, sustainOverallUnmanageableRiskScore, sustainabilityDimension, swissSanctionStatus, tbaPayup, temporary, thCoalAnalystComments, ticker, tikPmComments, tikResearchComments, topicCode, topicName, totalPotentialEmissions, traderId, trading_EM_Dev, traunch, ultimate, ultimateCompanyCode, ultimateParentCompanyName, ultimateParentCorpTicker, ultimateParentTickerExchange, unconvOilGasPotentialEmiss, underlyingId, unitedNationsSanctionStatus, urvEsgScore, urvEsgScoreChange, urvPrice, urvPriceSrc, vegaClean, yankee, yieldSource'
    valid_cols = valid_cols.split(', ')
    my_cols = cols.split(',')
    for col in my_cols:
        if col not in valid_cols:
            print('invalid field: ' + col)
            return False
    return True


def isValidESHoldingFields(cols):
    """
    Inputs>>
    cols: comma delimitted list of valid fields (as per API documentation)
    Outputs>>
    boolean: indicator if fields are all valid
    """
    valid_cols = 'date, entityId, securityId, finalAccruedIncomeBase, finalAccruedIncomeLocal, finalAccruedIncomeUSD, finalAmortBookParWeight, finalAmortBookPrice, finalAmortBookValue, finalAmortBookYield, finalAmortUgl, finalGlUSD, finalOriginalFaceBase, finalOriginalFaceUSD, finalParAmountUSD, finalParWeight, finalQuantity, finalQuantityWeight, finalTotalCostBase, finalTotalCostUSD, finalUnrealizedCapitalGainLossBase, finalUnrealizedCapitalGainLossUSD, finalUnrealizedGainLossMarketValue, finalUnrealizedGainLossMarketValueBase, finalUnrealizedGainLossMarketValueLocal, finalUnrealizedGainLossWeight, finalWeight, initialParWeight, initialQuantity, initialQuantityWeight, initialUnrealizedGainLossWeight, initialWeight, marketValue, marketValueBase, marketValueGainLoss, marketValueGainLossBase, pendingDividendAmount'
    valid_cols = valid_cols.split(', ')
    my_cols = cols.split(',')
    for col in my_cols:
        if col not in valid_cols:
            print('invalid field: ' + col)
            return False
    return True


def isValidESPositionFields(cols):
    """
    Inputs>>
    cols: comma delimitted list of valid fields (as per API documentation)
    Outputs>>
    boolean: indicator if fields are all valid
    """
    valid_cols = 'date, entityId, securityId, LSpropCollateralNetCoupon, LSpropCurrentCouponSpreadSensitivity, LSpropDiscountMargin, LSpropDuration, LSpropEffectiveConvexity, LSpropEffectiveDuration, LSpropEffectiveYield, LSpropLiborOptionAdjustedSpread, LSpropOptionAdjustedSpread, LSpropOriginationYear, LSpropPartialDuration02Year, LSpropPartialDuration05Year, LSpropPartialDuration07Year, LSpropPartialDuration10Year, LSpropPartialDuration20Year, LSpropPartialDuration30Year, LSpropPartialDurationCustom, LSpropPrepayDuration, LSpropPrice, LSpropSpreadConvexity, LSpropSpreadDelta7Day, LSpropSpreadDeltaMtd, LSpropSpreadDeltaNinetyDay, LSpropSpreadDeltaOneDay, LSpropSpreadDeltaQtd, LSpropSpreadDeltaThirtyDay, LSpropSpreadDeltaYtd, LSpropSpreadDuration, LSpropSpreadDurationPlusCouponSensitivity, LSpropSpreadPercentChange7Day, LSpropSpreadTimesSpreadDuration, LSpropVolatilityDuration, LSpropWeightedAverageLife, LSpropYieldToMaturity, LSpropYieldToWorst, LSpropZeroVolatilitySpread, adjustedKeyRateDurationBeta100DayTotal, adjustedKeyRateDurationBetaTotal, bankLoanRating, base12MonthExcessReturn, base12MonthReturn, braeburnPrice, compModifiedDurationToWorst, compSpreadPercentChangeMtd, compSpreadPercentChangeNinetyDay, compSpreadPercentChangeOneDay, compSpreadPercentChangeQtd, compSpreadPercentChangeThirtyDay, compSpreadPercentChangeYtd, convexity, coupon, cs01, currentCouponSpreadSensitivity, currentDividendYield, currentYield, customSecuritizedDuration, cv01, dirtyPrice, divYld12Months, dividendPaid, downside12MonthExcessReturn, downside12MonthReturn, duration, dv01, effectiveDuration, empiricalDuration, empiricalDurationRSquared, empiricalKeyRateDurationFiveYear, empiricalKeyRateDurationOffset, empiricalKeyRateDurationSixMonth, empiricalKeyRateDurationTenYear, empiricalKeyRateDurationThirtyYear, empiricalKeyRateDurationTwentyYear, empiricalKeyRateDurationTwoYear, faceValueFactor, feEst3to5YrEpsMeanLtGrowth, feForwardPe, feTrailingPe, ffAssetsAnnual, ffCapexPctSalesAnnual, ffCashFromOperationsAnnual, ffCashQtrly, ffDebtAnnual, ffDebtQtrly, ffDebtToCapital, ffDebtToCapitalDs, ffDivYldLastDivTimes4PlusSpec, ffDividendPayoutRatioAnnual, ffDividendsPerShareAnnual, ffEbitMarginAnnual, ffEbitdaMarginAnnual, ffEnterpriseValueQtrly, ffEpsAnnual, ffEpsLtm, ffEquityAnnual, ffFcfPerShareAnnual, ffFcfYieldDs, ffFreeCashFlowAnnual, ffFreeCashFlowPerShareLtm, ffGrossProfitMarginAnnual, ffLtDebtToCapitalAnnual, ffMarketCapAnnual, ffMarketCapDaily, ffMarketCapMillionsQtrly, ffNetIncomeAnnual, ffPToEDaily, ffPToEQtrly, ffPriceToBookDaily, ffPriceToBookDs, ffPriceToBookValueQtrly, ffPriceToCashFlow, ffPriceToCashFlowAnnual, ffPriceToCashFlowQtrly, ffPriceToCashflowDs, ffPriceToSales, ffPriceToSalesAnnual, ffPriceToSalesQtrly, ffReturnOnAssetsAnnual, ffRoeAnnual, ffRoeDs, ffSalesGrowthAnnual, ffSharesQtrly, ffSplitAdjPriceDaily, ffTaxRateAnnual, ffTotalDebtToEquity, ffTotalDebtToEquityAnnual, ffTotalDebtToEquityQtrly, ffTotlDivAnnual, fvSpread, hedgeCostAdjustedYieldAud1m, hedgeCostAdjustedYieldAud3m, hedgeCostAdjustedYieldCad1m, hedgeCostAdjustedYieldCad3m, hedgeCostAdjustedYieldEur1m, hedgeCostAdjustedYieldEur3m, hedgeCostAdjustedYieldGbp1m, hedgeCostAdjustedYieldGbp3m, hedgeCostAdjustedYieldJpy1m, hedgeCostAdjustedYieldJpy3m, hedgeCostAdjustedYieldNok1m, hedgeCostAdjustedYieldNok3m, hedgeCostAdjustedYieldNzd1m, hedgeCostAdjustedYieldNzd3m, hedgeCostAdjustedYieldSgd1m, hedgeCostAdjustedYieldSgd3m, hedgeCostAdjustedYieldUsd1m, hedgeCostAdjustedYieldUsd3m, impliedMbsCouponSwapConvexity, impliedMbsCouponSwapDuration, invertedFaceValueFactor, keyRateDurationBeta100DayFiveYear, keyRateDurationBeta100DayOneYear, keyRateDurationBeta100DaySevenYear, keyRateDurationBeta100DaySixMonths, keyRateDurationBeta100DayTenYear, keyRateDurationBeta100DayThirtyYear, keyRateDurationBeta100DayThreeYear, keyRateDurationBeta100DayTwentyYear, keyRateDurationBeta100DayTwoYear, keyRateDurationBetaFiveYear, keyRateDurationBetaOneYear, keyRateDurationBetaSevenYear, keyRateDurationBetaSixMonths, keyRateDurationBetaTenYear, keyRateDurationBetaThirtyYear, keyRateDurationBetaThreeYear, keyRateDurationBetaTwentyYear, keyRateDurationBetaTwoYear, keyRateDurationFiveYear, keyRateDurationOneYear, keyRateDurationSevenYear, keyRateDurationSixMonths, keyRateDurationTenYear, keyRateDurationThirtyYear, keyRateDurationThreeYear, keyRateDurationTwentyYear, keyRateDurationTwoYear, liborConvexity, liborDuration, liborSpread, liborSpreadDuration, liborZeroVolatilitySpread, liquidityCostScore, macaulayDurationToWorst, modifiedDurationToWorst, msciEsgCorpBusinessEthicsThemeScore, msciEsgCorpBusinessEthicsThemeWeight, msciEsgCorpCarbonEmissionsScore, msciEsgCorpCarbonEmissionsWeight, msciEsgCorpClimateChangeThemeScore, msciEsgCorpClimateChangeThemeWeight, msciEsgCorpCorporateGovThemeScore, msciEsgCorpCorporateGovThemeWeight, msciEsgCorpEnvironOppsThemeScore, msciEsgCorpEnvironOppsThemeWeight, msciEsgCorpEnvironmentalPillarScore, msciEsgCorpEnvironmentalPillarWeight, msciEsgCorpGovernancePillarScore, msciEsgCorpGovernancePillarWeight, msciEsgCorpGovtPubPolThemeScore, msciEsgCorpGovtPubPolThemeWeight, msciEsgCorpHumanCapitalThemeScore, msciEsgCorpHumanCapitalThemeWeight, msciEsgCorpIndustryAdjustedScore, msciEsgCorpNaturalResUseThemeScore, msciEsgCorpNaturalResUseThemeWeight, msciEsgCorpProdCarbFtprntExpScore, msciEsgCorpProdCarbFtprntMgmtScore, msciEsgCorpProdCarbFtprntScore, msciEsgCorpProdCarbFtprntWeight, msciEsgCorpProductSafetyThemeScore, msciEsgCorpProductSafetyThemeWeight, msciEsgCorpSocialOppsThemeScore, msciEsgCorpSocialOppsThemeWeight, msciEsgCorpSocialPillarScore, msciEsgCorpSocialPillarWeight, msciEsgCorpWasteMgmtThemeScore, msciEsgCorpWasteMgmtThemeWeight, mtgGenericCprOneMonth, mtgGenericCprSixMonth, mtgGenericCprThreeMonth, mtgPoolCprOneMonth, mtgPoolCprSixMonth, mtgPoolCprThreeMonth, optionAdjustedConvexity, optionAdjustedDuration, price, priceDelta180Day, priceDelta1Day, priceDelta30Day, priceDelta60Day, priceDelta7Day, priceDelta90Day, priceDeltaMTD, priceDeltaQTD, priceDeltaYTD, satAveragePrice, satDistressedLiquidity, satZvSpread, sfDuration, sfKeyRateDurationFiveYear, sfKeyRateDurationSevenYear, sfKeyRateDurationSixMonths, sfKeyRateDurationTenYear, sfKeyRateDurationThirtyYear, sfKeyRateDurationTwentyYear, sfKeyRateDurationTwoYear, sfOptionAdjustedConvexity, sfOptionAdjustedSpread, sfOptionAdjustedSpreadDuration, sfPrice, sfRiskModelTwoBeta, sfVolatilityDuration, spread, spreadConvexity, spreadDelta180Day, spreadDelta1Day, spreadDelta30Day, spreadDelta7Day, spreadDelta90Day, spreadDeltaMTD, spreadDeltaQTD, spreadDeltaYTD, spreadDuration, spreadDurationDeltaDays001, spreadDurationDeltaDays007, spreadDurationDeltaDays030, spreadDurationDeltaDays090, spreadDurationDeltaDays180, spreadDurationDeltaPeriodMTD, spreadDurationDeltaPeriodQTD, spreadDurationDeltaPeriodYTD, spreadDurationPlusCouponSensitivity, spreadSCR, spreadTimesSpreadDuration, spreadToBenchmark, upside12MonthExcessReturn, upside12MonthReturn, volatilityDuration, wac, yasIspreadToGovt, yearsToAverageLife, yearsToEffectiveMaturity, yearsToMaturity, yearsToWorst, yield, yieldToMaturity, yieldToWorst, zeroVolatilitySpread'
    valid_cols = valid_cols.split(', ')
    my_cols = cols.split(',')
    for col in my_cols:
        if col not in valid_cols:
            print('invalid field: ' + col)
            return False
    return True


def getEntyServSecurityAsOf(asofdate='PBD', \
                        eids='506455,455552010', \
                        cols='securityId,date,name,currencyCode,'+ \
                        'abstratRating,abstratRegionOfRisk,abstratIndustry', \
                        wfile=False,vapi=2):
    """
    Inputs>>
    asofdate: comma delimitted list of dates in any of 7 formats:
        MM/dd/yyyy, MM-dd-yyyy, yyyy-MM-dd, yyyy/MM/dd, dd.MM.yyyy, dd-MMM-yyyy, MMM-dd-yyyy
        that is after 1999-09-29 and on or before today
        or via shortcuts: PBD, PME, PQE, PYE
    eids: comma delimitted list of entity ids
    cols: comma delimitted list of valid fields (as per API documentation)
    wfile: boolean indicator whether to save data as csv file
    Outputs>>
    dataframe: data returned from api, None if invalid
    """
    # Validate Inputs
    if not isValidESSecurityFields(cols):
        return
    # Run Query on Security Service REST API
    if vapi == 1:
        url = 'http://in2apps/entityserviceui/entityservice/rest/query/type'
    elif vapi == 2:
        url = 'http://ace/prd/imt/flatgrouping/entityservice/rest/query/type'
    else:
        url = 'http://in2apps/entityserviceui/entityservice/rest/query/type'
    df = pd.read_csv(url+'/Security.csv?'+ \
                     'appName=TQ&relative=false&lookthru=false'+ \
                     '&entityDates='+asofdate+ \
                     '&entityIds='+eids+ \
                     '&select='+cols)
    # Export Data into CSV File
    if wfile:
        df.to_csv('data_'+str(datetime.datetime.now().timestamp())+'.csv')
    # Return DataFrame of Data
    return df


def getEntyServHoldingAsOf(asofdate='PBD', \
                        eids='506455,455552010', \
                        cols='entityId,securityId,date,finalParAmountUSD,marketValue', \
                        wfile=False,vapi=2):
    """
    Inputs>>
    asofdate: comma delimitted list of dates in any of 7 formats:
        MM/dd/yyyy, MM-dd-yyyy, yyyy-MM-dd, yyyy/MM/dd, dd.MM.yyyy, dd-MMM-yyyy, MMM-dd-yyyy
        that is after 1999-09-29 and on or before today
        or via shortcuts: PBD, PME, PQE, PYE
    eids: comma delimitted list of entity ids
    cols: comma delimitted list of valid fields (as per API documentation)
    wfile: boolean indicator whether to save data as csv file
    Outputs>>
    dataframe: data returned from api, None if invalid
    """
    # Validate Inputs
    if not isValidESHoldingFields(cols):
        return
    # Run Query on Security Service REST API
    if vapi == 1:
        url = 'http://in2apps/entityserviceui/entityservice/rest/query/type'
    elif vapi == 2:
        url = 'http://ace/prd/imt/flatgrouping/entityservice/rest/query/type'
    else:
        url = 'http://in2apps/entityserviceui/entityservice/rest/query/type'
    df = pd.read_csv(url+'/Holding.csv?'+ \
                     'appName=TQ&relative=false&lookthru=false'+ \
                     '&entityDates='+asofdate+ \
                     '&entityIds='+eids+ \
                     '&select='+cols)
    # Export Data into CSV File
    if wfile:
        df.to_csv('data_'+str(datetime.datetime.now().timestamp())+'.csv')
    # Return DataFrame of Data
    return df


def getEntyServPositionAsOf(asofdate='PBD', \
                        eids='506455,455552010', \
                        cols='entityId,securityId,date,currentYield,yearsToMaturity,'+ \
                        'effectiveDuration,spread,spreadDuration,keyRateDurationSixMonths,'+ \
                        'keyRateDurationTwoYear,keyRateDurationFiveYear,keyRateDurationTenYear,'+ \
                        'keyRateDurationTwentyYear,keyRateDurationThirtyYear', \
                        wfile=False,vapi=2):
    """
    Inputs>>
    asofdate: comma delimitted list of dates in any of 7 formats:
        MM/dd/yyyy, MM-dd-yyyy, yyyy-MM-dd, yyyy/MM/dd, dd.MM.yyyy, dd-MMM-yyyy, MMM-dd-yyyy
        that is after 1999-09-29 and on or before today
        or via shortcuts: PBD, PME, PQE, PYE
    eids: comma delimitted list of entity ids
    cols: comma delimitted list of valid fields (as per API documentation)
    wfile: boolean indicator whether to save data as csv file
    Outputs>>
    dataframe: data returned from api, None if invalid
    """
    # Validate Inputs
    if not isValidESPositionFields(cols):
        return
    # Run Query on Security Service REST API
    if vapi == 1:
        url = 'http://in2apps/entityserviceui/entityservice/rest/query/type'
    elif vapi == 2:
        url = 'http://ace/prd/imt/flatgrouping/entityservice/rest/query/type'
    else:
        url = 'http://in2apps/entityserviceui/entityservice/rest/query/type'
    df = pd.read_csv(url+'/Position.csv?'+ \
                     'appName=TQ&relative=false&lookthru=false'+ \
                     '&entityDates='+asofdate+ \
                     '&entityIds='+eids+ \
                     '&select='+cols)
    # Export Data into CSV File
    if wfile:
        df.to_csv('data_'+str(datetime.datetime.now().timestamp())+'.csv')
    # Return DataFrame of Data
    return df


__all__ = ["isValidESSecurityFields", "getEntyServSecurityAsOf", \
           "isValidESPositionFields", "getEntyServHoldingAsOf", \
           "isValidESHoldingFields", "getEntyServPositionAsOf"]

